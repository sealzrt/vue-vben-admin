var Nt=Object.defineProperty,zt=Object.defineProperties;var Lt=Object.getOwnPropertyDescriptors;var Xe=Object.getOwnPropertySymbols;var Mt=Object.prototype.hasOwnProperty,Ut=Object.prototype.propertyIsEnumerable;var Ye=(n,a,t)=>a in n?Nt(n,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[a]=t,F=(n,a)=>{for(var t in a||(a={}))Mt.call(a,t)&&Ye(n,t,a[t]);if(Xe)for(var t of Xe(a))Ut.call(a,t)&&Ye(n,t,a[t]);return n},me=(n,a)=>zt(n,Lt(a));var Y=(n,a,t)=>new Promise((l,o)=>{var i=c=>{try{g(t.next(c))}catch(s){o(s)}},d=c=>{try{g(t.throw(c))}catch(s){o(s)}},g=c=>c.done?l(c.value):Promise.resolve(c.value).then(i,d);g((t=t.apply(n,a)).next())});import{d as ee,Z as D,_ as de,N as Ce,E as re,a0 as U,l as R,u as e,c as P,f as N,w as be,H as we,m as je,r as rt,h as Ge,o as We,x as De,an as Vt,J as ut,a7 as ft,a8 as j,a9 as T,$ as fe,a1 as ve,ab as X,F as jt,aa as Ve,n as dt,z as gt,ag as Gt,e as Wt,ad as et,ai as Ke,aj as Be,ac as tt}from"./vue-d56f5f31.js";import{_ as qt}from"./BasicForm.vue_vue_type_script_setup_true_lang-642f17c1.js";import"./BasicForm.vue_vue_type_style_index_0_lang-02a2ab57.js";import{P as qe,b as Jt,D as Zt,I as Ae,A as ze,R as ue,F as Qt,u as Ee,d as Xt}from"./componentMap-e24e33c4.js";import{u as Yt}from"./useForm-c38c055a.js";import{a1 as nt,f as xe,h as _e,H as Ne,Q as en,a2 as tn,D as nn,G as an,a3 as ln,Z as on,y as at,a4 as ht,a5 as sn,V as cn,c as rn,r as Ue,E as un,P as fn,U as dn}from"./entry/index-1163f12d-1703821863576.js";import{aH as gn,ag as pe,aI as hn,aJ as mn,f as Se,e as q,k as Le,a as pn,aK as Cn,aL as vn,ac as lt,o as Je,aG as Sn,a2 as $e,aM as bn,T as Re,a3 as mt,aN as wn,d as ot,D as yn,x as He,aO as _n,aP as Tn,aC as Rn,aB as xn,ar as In,aQ as kn}from"./antd-090f1744.js";import{a as Fn,u as pt,b as Pn,c as $n,d as Dn}from"./TableImg.vue_vue_type_style_index_0_lang-00dde315.js";import{b as st}from"./uuid-31b8b5a4.js";import An from"./sortable.esm-4ae27e0b.js";const En={class:"edit-header-cell"},ct=ee({name:"EditTableHeaderIcon",__name:"EditTableHeaderIcon",props:{title:{type:String,default:""}},setup(n){return(a,t)=>(D(),de("span",En,[Ce(a.$slots,"default"),re(" "+U(n.title)+" ",1),R(e(gn))]))}}),On=ee({name:"TableHeaderCell",components:{EditTableHeaderCell:ct,BasicHelp:nt},props:{column:{type:Object,default:()=>({})}},setup(n){const{prefixCls:a}=xe("basic-table-header-cell"),t=P(()=>{var i;return!!((i=n.column)!=null&&i.edit)}),l=P(()=>{var d;const i=n.column;return typeof i.customHeaderRender=="function"?i.customHeaderRender(i):(i==null?void 0:i.customTitle)||((d=n.column)==null?void 0:d.title)}),o=P(()=>{var i;return(i=n.column)==null?void 0:i.helpMessage});return()=>R("div",null,[t.value?R(ct,null,{default:()=>[l.value]}):R("span",{class:"default-header-cell"},[l.value]),o.value&&R(nt,{text:o.value,class:`${a}__help`},null)])}});function Kn({page:n,type:a,originalElement:t}){return a==="prev"?n===0?null:R(hn,null,null):a==="next"?n===1?null:R(mn,null,null):t}function Bn(n){const{t:a}=_e(),t=N({}),l=N(!0);be(()=>e(n).pagination,s=>{!pe(s)&&s&&(t.value=F(F({},e(t)),s!=null?s:{}))});const o=P(()=>{const{pagination:s}=e(n);return!e(l)||pe(s)&&!s?!1:F(F({current:1,size:"small",defaultPageSize:qe,showTotal:w=>a("component.table.total",{total:w}),showSizeChanger:!0,pageSizeOptions:Jt,itemRender:Kn,showQuickJumper:!0},pe(s)?{}:s),e(t))});function i(s){const w=e(o);t.value=F(F({},pe(w)?{}:w),s)}function d(){return e(o)}function g(){return e(l)}function c(s){return Y(this,null,function*(){l.value=s})}return{getPagination:d,getPaginationInfo:o,setShowPagination:c,getShowPagination:g,setPagination:i}}function Hn(n){return({text:a,record:t,index:l})=>(we(t).onValid=()=>Y(this,null,function*(){if(Ne(t==null?void 0:t.validCbs)){const o=((t==null?void 0:t.validCbs)||[]).map(d=>d());return(yield Promise.all(o)).every(d=>!!d)}else return!1}),we(t).onEdit=(o,i=!1)=>Y(this,null,function*(){var d,g;return i||(t.editable=o),!o&&i?(yield t.onValid())&&(yield(d=t.onSubmitEdit)==null?void 0:d.call(t))?(t.editable=!1,!0):!1:(!o&&!i&&((g=t.onCancelEdit)==null||g.call(t)),!0)}),je(Fn,{value:a,record:t,column:n,index:l}))}function Ct(n,a){const{key:t,dataIndex:l,children:o}=n;n.align=n.align||Zt,a&&(t||(n.key=typeof l=="object"?l.join("-"):l),pe(n.ellipsis)||Object.assign(n,{ellipsis:a})),o&&o.length&&vt(o,!!a)}function vt(n,a){n&&n.forEach(t=>{const{children:l}=t;Ct(t,a),vt(l,a)})}function Nn(n,a,t){const{t:l}=_e(),{showIndexColumn:o,indexColumnProps:i,isTreeTable:d}=e(n);let g=!1;if(e(d)||(t.forEach(()=>{const s=t.findIndex(w=>w.flag===Ae);o?g=s===-1:!o&&s!==-1&&t.splice(s,1)}),!g))return;const c=t.some(s=>s.fixed==="left");t.unshift(F(F({flag:Ae,width:60,title:l("component.table.index"),align:"center",customRender:({index:s})=>{const w=e(a);if(pe(w))return`${s+1}`;const{current:A=1,pageSize:S=qe}=w;return((A<1?1:A)-1)*S+s+1}},c?{fixed:"left"}:{}),i))}function zn(n,a){const{actionColumn:t}=e(n);if(!t)return;const l=a.findIndex(o=>o.flag===ze);l===-1&&a.push(me(F(me(F({},a[l]),{fixed:"right"}),t),{flag:ze}))}function Ln(n,a){const t=N(e(n).columns);let l=e(n).columns;const o=P(()=>{const u=Se(e(t));if(Nn(n,a,u),zn(n,u),!u)return[];const{ellipsis:f}=e(n);return u.forEach(v=>{const{customRender:y,slots:p}=v;Ct(v,Reflect.has(v,"ellipsis")?!!v.ellipsis:!!f&&!y&&!p)}),u});function i(u){const f=u.ifShow;let v=!0;return pe(f)&&(v=f),q(f)&&(v=f(u)),v}const{hasPermission:d}=en(),g=P(()=>{const u=it(e(o)),f=y=>{const{slots:p,customRender:O,format:I,edit:B,editRow:G,flag:te}=y;(!p||!(p!=null&&p.title))&&(y.customTitle=y.title);const ne=[Ae,ze].includes(te);return!O&&I&&!B&&!ne&&(y.customRender=({text:ye,record:h,index:C})=>Mn(ye,I,h,C)),(B||G)&&!ne&&(y.customRender=Hn(y)),rt(y)};return Se(u).filter(y=>d(y.auth)&&i(y)).map(y=>{var p;return(p=y.children)!=null&&p.length&&(y.children=y.children.map(f)),f(y)})});be(()=>e(n).columns,u=>{var f;t.value=u,l=(f=u==null?void 0:u.filter(v=>!v.flag))!=null?f:[]});function c(u,f){!u||!f||l.forEach(v=>{if(v.dataIndex===u){Object.assign(v,f);return}})}function s(u){const f=Se(u);if(!Ne(f))return;if(f.length<=0){t.value=[];return}const v=f[0],y=l.map(p=>p.dataIndex);if(!Le(v)&&!Ne(v))t.value=f;else{const p=f.map(I=>I.toString()),O=[];l.forEach(I=>{var B;O.push(me(F({},I),{defaultHidden:!p.includes(((B=I.dataIndex)==null?void 0:B.toString())||I.key)}))}),pn(y,f)||O.sort((I,B)=>{var G,te;return p.indexOf((G=I.dataIndex)==null?void 0:G.toString())-p.indexOf((te=B.dataIndex)==null?void 0:te.toString())}),t.value=O}}function w(u){const{ignoreIndex:f,ignoreAction:v,sort:y}=u||{};let p=we(e(o));return f&&(p=p.filter(O=>O.flag!==Ae)),v&&(p=p.filter(O=>O.flag!==ze)),y&&(p=it(p)),p}function A(){return l}function S(u){Ne(u)&&(l=u.filter(f=>!f.flag))}function x(u,f){f.width=u}return{getColumnsRef:o,getCacheColumns:A,getColumns:w,setColumns:s,setColumnWidth:x,getViewColumns:g,setCacheColumnsByField:c,setCacheColumns:S}}function it(n){const a=[],t=[],l=[];for(const o of n){if(o.fixed==="left"){a.push(o);continue}if(o.fixed==="right"){t.push(o);continue}l.push(o)}return[...a,...l,...t].filter(o=>!o.defaultHidden)}function Mn(n,a,t,l){if(!a)return n;if(q(a))return a(n,t,l);try{const o="date|";if(Le(a)&&a.startsWith(o)&&n){const i=a.replace(o,"");return i?tn(n,i):n}if(Cn(a))return a.get(n)}catch(o){return n}}function Un(n,{getPaginationInfo:a,setPagination:t,setLoading:l,getFieldsValue:o,clearSelectedRowKeys:i,tableData:d},g){const c=rt({sortInfo:{},filterInfo:{}}),s=N([]),w=N({});Ge(()=>{d.value=e(s)}),be(()=>e(n).dataSource,()=>{const{dataSource:h,api:C}=e(n);!C&&h&&(s.value=h)},{immediate:!0});function A(h,C,$){const{clearSelectOnPageChange:E,sortFn:z,filterFn:L}=e(n);E&&i(),t(h);const M={};if($&&q(z)){const K=z($);c.sortInfo=K,M.sortInfo=K}if(C&&q(L)){const K=L(C);c.filterInfo=K,M.filterInfo=K}B(M)}function S(h){!h||!Array.isArray(h)||h.forEach(C=>{C[ue]||(C[ue]=st()),C.children&&C.children.length&&S(C.children)})}const x=P(()=>e(n).autoCreateKey&&!e(n).rowKey),u=P(()=>{const{rowKey:h}=e(n);return e(x)?ue:h}),f=P(()=>{const h=e(s);if(!h||h.length===0)return e(s);if(e(x)){const C=h[0],$=h[h.length-1];if(C&&$&&(!C[ue]||!$[ue])){const E=Se(e(s));E.forEach(z=>{z[ue]||(z[ue]=st()),z.children&&z.children.length&&S(z.children)}),s.value=E}}return e(s)});function v(h,C,$){return Y(this,null,function*(){return s.value[h]&&(s.value[h][C]=$),s.value[h]})}function y(h,C){const $=I(h);if($){for(const E in $)Reflect.has(C,E)&&($[E]=C[E]);return $}}function p(h){var z;if(!s.value||s.value.length==0)return;const C=e(u);if(!C)return;const $=Array.isArray(h)?h:[h];function E(L,M){const K=ae(L,M);if(K===null||K.index===-1)return;K.data.splice(K.index,1);function ae(Z,le){var oe;if(Z==null)return null;for(let W=0;W<Z.length;W++){const J=Z[W];let se=C;if(q(C)&&(se=C(J)),J[se]===le)return{index:W,data:Z};if(((oe=J.children)==null?void 0:oe.length)>0){const ge=ae(J.children,le);if(ge!=null)return ge}}return null}}for(const L of $)E(s.value,L),E(e(n).dataSource,L);t({total:(z=e(n).dataSource)==null?void 0:z.length})}function O(h,C){var E;C=C!=null?C:(E=s.value)==null?void 0:E.length;const $=an(h)?[h]:h;return e(s).splice(C,0,...$),e(s)}function I(h){if(!s.value||s.value.length==0)return;const C=e(u);if(!C)return;const{childrenColumnName:$="children"}=e(n);return(z=>{let L;return z.some(function M(K){if(typeof C=="function"){if(C(K)===h)return L=K,!0}else if(Reflect.has(K,C)&&K[C]===h)return L=K,!0;return K[$]&&K[$].some(M)}),L})(s.value)}function B(h){return Y(this,null,function*(){var Z,le,oe;const{api:C,searchInfo:$,defSort:E,fetchSetting:z,beforeFetch:L,afterFetch:M,useSearchForm:K,pagination:ae}=e(n);if(!(!C||!q(C)))try{l(!0);const{pageField:W,sizeField:J,listField:se,totalField:ge}=Object.assign({},Qt,z);let he={};const{current:Ie=1,pageSize:Te=qe}=e(a);pe(ae)&&!ae||pe(a)?he={}:(he[W]=h&&h.page||Ie,he[J]=Te);const{sortInfo:ke={},filterInfo:r}=c;let b=vn(he,K?o():{},$,(Z=h==null?void 0:h.searchInfo)!=null?Z:{},E,ke,r,(le=h==null?void 0:h.sortInfo)!=null?le:{},(oe=h==null?void 0:h.filterInfo)!=null?oe:{});L&&q(L)&&(b=(yield L(b))||b);const _=yield C(b);w.value=_;const m=Array.isArray(_);let k=m?_:lt(_,se);const ce=m?_.length:lt(_,ge);if(Number(ce)){const ie=Math.ceil(ce/Te);if(Ie>ie)return t({current:ie}),yield B(h)}return M&&q(M)&&(k=(yield M(k))||k),s.value=k,t({total:ce||0}),h&&h.page&&t({current:h.page||1}),g("fetch-success",{items:e(k),total:ce}),k}catch(W){g("fetch-error",W),s.value=[],t({total:0})}finally{l(!1)}})}function G(h){s.value=h}function te(){return f.value}function ne(){return w.value}function ye(h){return Y(this,null,function*(){return yield B(h)})}return We(()=>{nn(()=>{e(n).immediate&&B()},16)}),{getDataSourceRef:f,getDataSource:te,getRawDataSource:ne,getRowKey:u,setTableData:G,getAutoCreateKey:x,fetch:B,reload:ye,updateTableData:v,updateTableDataRecord:y,deleteTableDataRecord:p,insertTableDataRecord:O,findTableDataRecord:I,handleTableChange:A}}function Vn(n){const a=N(e(n).loading);be(()=>e(n).loading,o=>{a.value=o});const t=P(()=>e(a));function l(o){a.value=o}return{getLoading:t,setLoading:l}}function jn(n,a,t){const l=N([]),o=N([]),i=P(()=>{const{rowSelection:f}=e(n);return f?F({selectedRowKeys:e(l),onChange:(v,y)=>{var p;c(v),(p=f.onChange)==null||p.call(f,v,y)}},Je(f,["onChange"])):null});be(()=>{var f;return(f=e(n).rowSelection)==null?void 0:f.selectedRowKeys},f=>{c(f)}),be(()=>e(l),()=>{De(()=>{const{rowSelection:f}=e(n);if(f){const{onChange:v}=f;v&&q(v)&&v(S(),x())}t("selection-change",{keys:S(),rows:x()})})},{deep:!0});const d=P(()=>e(n).autoCreateKey&&!e(n).rowKey),g=P(()=>{const{rowKey:f}=e(n);return e(d)?ue:f});function c(f){var p;l.value=f||[];const v=ln(we(e(a)).concat(we(e(o))),O=>f==null?void 0:f.includes(O[e(g)]),{children:(p=n.value.childrenColumnName)!=null?p:"children"}),y=[];f==null||f.forEach(O=>{const I=v.find(B=>B[e(g)]===O);I&&y.push(I)}),o.value=y}function s(f){const{rowKey:v}=e(n);o.value=f,l.value=o.value.map(y=>{const p=(q(v)?v(y):v)||"key";return y[p]})}function w(){o.value=[],l.value=[]}function A(f){const y=e(l).findIndex(p=>p===f);y!==-1&&e(l).splice(y,1)}function S(){return e(l)}function x(){return e(o)}function u(){return e(i)}return{getRowSelection:u,getRowSelectionRef:i,getSelectRows:x,getSelectRowKeys:S,setSelectedRowKeys:c,clearSelectedRowKeys:w,deleteSelectRowByKey:A,setSelectedRows:s}}function Gn(n,a){let t;function l(i){return Y(this,null,function*(){var c;const{id:d}=i,g=t==null?void 0:t.querySelector(`[data-row-key="${d}"]`);yield De(),t==null||t.scrollTo({top:(c=g==null?void 0:g.offsetTop)!=null?c:0,behavior:"smooth"})})}function o(i){const d=e(n);if(!d)return;const g=d.$el;if(!g||!t&&(t=g.querySelector(".ant-table-body"),!t))return;const c=e(a);if(c)if(i==="top")l(c[0]);else if(i==="bottom")l(c[c.length-1]);else{const s=c.find(w=>w.id===i);s&&l(s)}}return{scrollTo:o}}function Wn(n,a,t){return!a||t?n[ue]:Le(a)?n[a]:q(a)?n[a(n)]:null}function qn(n,{setSelectedRowKeys:a,getSelectRowKeys:t,getAutoCreateKey:l,clearSelectedRowKeys:o,emit:i}){return{customRow:(g,c)=>({onClick:s=>{s==null||s.stopPropagation();function w(){var p;const{rowSelection:A,rowKey:S,clickToRowSelect:x}=e(n);if(!A||!x)return;const u=t()||[],f=Wn(g,S,e(l));if(f===null)return;if(A.type==="checkbox"){const O=(p=s.composedPath)==null?void 0:p.call(s).find(G=>G.tagName==="TR");if(!O)return;const I=O.querySelector("input[type=checkbox]");if(!I||I.hasAttribute("disabled"))return;if(!u.includes(f)){u.push(f),a(u);return}const B=u.findIndex(G=>G===f);u.splice(B,1),a(u);return}if(A.type==="radio"){if(!u.includes(f)){u.length&&o(),a([f]);return}o()}}w(),i("row-click",g,c,s)},onDblclick:s=>{i("row-dbClick",g,c,s)},onContextmenu:s=>{i("row-contextmenu",g,c,s)},onMouseenter:s=>{i("row-mouseenter",g,c,s)},onMouseleave:s=>{i("row-mouseleave",g,c,s)}})}}function Jn(n,a){function t(l,o){const{striped:i,rowClassName:d}=e(n),g=[];return i&&g.push((o||0)%2===1?`${a}-row__striped`:""),d&&q(d)&&g.push(d(l,o)),g.filter(c=>!!c).join(" ")}return{getRowClassName:t}}const Zn=["data-no"],Qn=ee({name:"ColumnSetting",__name:"ColumnSetting",props:{cache:{type:Boolean,default:()=>!1}},emits:["columns-change"],setup(n,{emit:a}){const t=n,l=pt(),o=Vt(),{t:i}=_e(),{prefixCls:d}=xe("basic-column-setting"),g=ut(),c=Ee(),s=()=>q(g.getPopupContainer)?g.getPopupContainer():ht();let w=!1,A=!1;const S=N([]),x=N(null),u=N([]);be(u,()=>{w&&(S.value.filter(r=>u.value.includes(r.value)).forEach(r=>{r.column.defaultHidden=!1}),S.value.filter(r=>!u.value.includes(r.value)).forEach(r=>{r.column.defaultHidden=!0,r.fixed=void 0}),ae(),E(),t.cache&&G())});const f=N(!1),v=()=>{u.value.length<S.value.length?u.value=S.value.map(r=>r.value):u.value=[]},y=P(()=>u.value.length>0&&u.value.length<S.value.length),p=N(!1),O=r=>{Z(r.target.checked),t.cache&&l.setShowIndexColumn(r.target.checked)},I=N(!1),B=r=>{le(r.target.checked),t.cache&&l.setShowRowSelection(r.target.checked)},G=()=>{typeof o.name=="string"&&l.setColumns(o.name,S.value)},te=()=>{p.value=W,O({target:{checked:W}}),I.value=J,B({target:{checked:J}}),S.value=Se(ge),oe()},ne=(r,b)=>{b==="left"?!r.fixed||r.fixed==="right"?r.fixed="left":r.fixed=void 0:b==="right"&&(!r.fixed||r.fixed==="left"?r.fixed="right":r.fixed=void 0),E(),t.cache&&G()},ye=()=>Y(this,null,function*(){if(x.value){const r=x.value.$el;Array.from(r.children).forEach(b=>r.removeChild(b))}yield De()}),h=r=>{if(r){if("ifShow"in r){if(typeof r.ifShow=="boolean")return r.ifShow;if(r.ifShow)return r.ifShow(r)}return!0}return!1},C=()=>c.getColumns({ignoreIndex:!0,ignoreAction:!0}).filter(r=>h(r)),$=r=>{A=!0,c==null||c.setColumns(r);const b=r.map(_=>({dataIndex:_.dataIndex?_.dataIndex.toString():"",fixed:_.fixed,visible:!_.defaultHidden}));a("columns-change",b)},E=()=>{var m;const r=Se(c.getColumns());let b=r.filter(k=>k.flag!==Ae&&(k.fixed==="left"||k.fixed===!0)).length;p.value&&b++;for(const k of S.value){const ce=r.findIndex(ie=>ie.dataIndex===k.value);if(ce>-1){const ie=r[ce];ie.defaultHidden=(m=k.column)==null?void 0:m.defaultHidden,ie.fixed=k.fixed,r.splice(ce,1),r.splice(b++,0,ie)}}const _=r.findIndex(k=>k.dataIndex==="action");if(_>-1){const k=r.splice(_,1);r.push(k[0])}$(r)},z=()=>Y(this,null,function*(){if(yield De(),x.value){const r=x.value.$el;An.create(e(r),{animation:500,delay:400,delayOnTouchOnly:!0,handle:".table-column-drag-icon ",dataIdAttr:"data-no",onEnd:b=>{const{oldIndex:_,newIndex:m}=b;if(ot(_)||ot(m)||_===m)return;const k=Se(S.value);_>m?(k.splice(m,0,k[_]),k.splice(_+1,1)):(k.splice(m+1,0,k[_]),k.splice(_,1)),S.value=k,E(),t.cache&&G()}})}}),L=()=>{if(typeof o.name=="string"){let r=l.getColumns(o.name);if(r&&JSON.stringify(S.value.map(b=>({value:b.value,label:b.label})))!==JSON.stringify(r.map(b=>({value:b.value,label:b.label})))){const b=S.value.reduce((_,m)=>(_[m.value]=m.label,_),{});if(Array.isArray(r)){r=r.filter(m=>b[m.value]),r.forEach(m=>{m.label=b[m.value]});const _=r.map(m=>m.value);r=r.concat(S.value.filter(m=>!_.includes(m.value))),l.setColumns(o.name,r)}}}},M=()=>{if(typeof l.getShowIndexColumn=="boolean"&&(p.value=W&&l.getShowIndexColumn),typeof l.getShowRowSelection=="boolean"&&(I.value=J&&l.getShowRowSelection),O({target:{checked:p.value}}),B({target:{checked:I.value}}),typeof o.name=="string"){const r=l.getColumns(o.name);Array.isArray(r)&&(S.value=r)}},K=()=>{u.value=S.value.filter(r=>{var b;return!((b=r.column)!=null&&b.defaultHidden)}).map(r=>r.value)},ae=()=>{f.value=S.value.length===u.value.length},Z=r=>{A=!0,c.setProps({showIndexColumn:r})},le=r=>{A=!0,c.setProps({rowSelection:r?me(F({},Je(se,["selectedRowKeys"])),{fixed:!0}):void 0})},oe=()=>{K(),ae(),Z(p.value),le(I.value),E()};let W=!1,J=!1,se,ge=[];const he=()=>Y(this,null,function*(){var r;if(!w){const b=C();(r=c.setCacheColumns)==null||r.call(c,b);const _=[];for(const m of b)_.push({label:typeof m.title=="string"?m.title:m.customTitle==="string"?m.customTitle:"",value:typeof m.dataIndex=="string"?m.dataIndex:m.title==="string"?m.title:"",column:{defaultHidden:m.defaultHidden},fixed:m.fixed});W=c.getBindValues.value.showIndexColumn||!1,se=c.getRowSelection(),J=!!se,ge=_,p.value=W,I.value=J,S.value=Se(_),t.cache&&L(),t.cache&&M(),oe(),w=!0}});(()=>Y(this,null,function*(){yield ye(),he()}))();const Te=P(()=>c==null?void 0:c.getColumns()),ke=P(()=>c==null?void 0:c.getBindValues);return We(()=>{be([Te,ke],()=>{A?A=!1:(w=!1,he())})}),(r,b)=>{const _=ft("a-button");return D(),j(e(Re),{placement:"top"},{title:T(()=>[fe("span",null,U(e(i)("component.table.settingColumn")),1)]),default:T(()=>[R(e(Sn),{placement:"bottomLeft",trigger:"click",onOpenChange:z,overlayClassName:`${e(d)}__column-list`,getPopupContainer:s},{title:T(()=>[fe("div",{class:ve(`${e(d)}__popover-title`)},[R(e($e),{indeterminate:y.value,checked:f.value,"onUpdate:checked":b[0]||(b[0]=m=>f.value=m),onChange:v},{default:T(()=>[re(U(e(i)("component.table.settingColumnShow")),1)]),_:1},8,["indeterminate","checked"]),R(e($e),{checked:p.value,"onUpdate:checked":b[1]||(b[1]=m=>p.value=m),onChange:O},{default:T(()=>[re(U(e(i)("component.table.settingIndexColumnShow")),1)]),_:1},8,["checked"]),e(J)?(D(),j(e($e),{key:0,checked:I.value,"onUpdate:checked":b[2]||(b[2]=m=>I.value=m),onChange:B},{default:T(()=>[re(U(e(i)("component.table.settingSelectColumnShow")),1)]),_:1},8,["checked"])):X("",!0),R(_,{size:"small",type:"link",onClick:te},{default:T(()=>[re(U(e(i)("common.resetText")),1)]),_:1})],2)]),content:T(()=>[R(e(on),null,{default:T(()=>[R(e($e).Group,{value:u.value,"onUpdate:value":b[3]||(b[3]=m=>u.value=m),ref_key:"columnOptionsRef",ref:x},{default:T(()=>[(D(!0),de(jt,null,Ve(S.value,m=>(D(),de("div",{key:m.value,class:ve(`${e(d)}__check-item`),"data-no":m.value},[R(e(bn),{class:"table-column-drag-icon"}),R(e($e),{value:m.value},{default:T(()=>[re(U(m.label),1)]),_:2},1032,["value"]),R(e(Re),{placement:"bottomLeft",mouseLeaveDelay:.4,getPopupContainer:s},{title:T(()=>[re(U(e(i)("component.table.settingFixedLeft")),1)]),default:T(()=>[R(at,{icon:"line-md:arrow-align-left",class:ve([`${e(d)}__fixed-left`,{active:m.fixed==="left",disabled:m.value?!u.value.includes(m.value):!0}]),onClick:k=>ne(m,"left")},null,8,["class","onClick"])]),_:2},1024),R(e(mt),{type:"vertical"}),R(e(Re),{placement:"bottomLeft",mouseLeaveDelay:.4,getPopupContainer:s},{title:T(()=>[re(U(e(i)("component.table.settingFixedRight")),1)]),default:T(()=>[R(at,{icon:"line-md:arrow-align-left",class:ve([`${e(d)}__fixed-right`,{active:m.fixed==="right",disabled:m.value?!u.value.includes(m.value):!0}]),onClick:k=>ne(m,"right")},null,8,["class","onClick"])]),_:2},1024)],10,Zn))),128))]),_:1},8,["value"])]),_:1})]),default:T(()=>[R(e(wn))]),_:1},8,["overlayClassName"])]),_:1})}}}),Xn=ee({name:"SizeSetting",__name:"SizeSetting",setup(n){const a=pt(),t=Ee(),{t:l}=_e(),o=N([t.getSize()]),i=({key:d})=>{o.value=[d],a.setTableSize(d),t.setProps({size:d})};return We(()=>{o.value=[a.getTableSize],t.setProps({size:o.value[0]})}),(d,g)=>(D(),j(e(Re),{placement:"top"},{title:T(()=>[fe("span",null,U(e(l)("component.table.settingDens")),1)]),default:T(()=>[R(e(yn),{placement:"bottom",trigger:["click"],getPopupContainer:e(ht)},{overlay:T(()=>[R(e(He),{onClick:i,selectable:"",selectedKeys:o.value,"onUpdate:selectedKeys":g[0]||(g[0]=c=>o.value=c)},{default:T(()=>[R(e(He).Item,{key:"default"},{default:T(()=>[fe("span",null,U(e(l)("component.table.settingDensDefault")),1)]),_:1}),R(e(He).Item,{key:"middle"},{default:T(()=>[fe("span",null,U(e(l)("component.table.settingDensMiddle")),1)]),_:1}),R(e(He).Item,{key:"small"},{default:T(()=>[fe("span",null,U(e(l)("component.table.settingDensSmall")),1)]),_:1})]),_:1},8,["selectedKeys"])]),default:T(()=>[R(e(_n))]),_:1},8,["getPopupContainer"])]),_:1}))}}),Yn=ee({name:"RedoSetting",__name:"RedoSetting",setup(n){const a=Ee(),{t}=_e();function l(){a.reload()}return(o,i)=>(D(),j(e(Re),{placement:"top"},{title:T(()=>[fe("span",null,U(e(t)("common.redo")),1)]),default:T(()=>[R(e(Tn),{onClick:l})]),_:1}))}}),ea=ee({name:"FullScreenSetting",__name:"FullScreenSetting",setup(n){const a=Ee(),{t}=_e(),{toggle:l,isFullscreen:o}=sn(a.wrapRef);return(i,d)=>(D(),j(e(Re),{placement:"top"},{title:T(()=>[fe("span",null,U(e(t)("component.table.settingFullScreen")),1)]),default:T(()=>[e(o)?(D(),j(e(xn),{key:1,onClick:e(l)},null,8,["onClick"])):(D(),j(e(Rn),{key:0,onClick:e(l)},null,8,["onClick"]))]),_:1}))}}),ta={class:"table-settings"},na=ee({name:"TableSetting",__name:"index",props:{setting:{type:Object,default:()=>({})}},emits:["columns-change"],setup(n,{emit:a}){const t=n,l=Ee(),o=P(()=>F({redo:!0,size:!0,setting:!0,settingCache:!1,fullScreen:!1},t.setting));function i(g){a("columns-change",g)}function d(){return l?e(l.wrapRef):document.body}return(g,c)=>(D(),de("div",ta,[o.value.redo?(D(),j(Yn,{key:0,getPopupContainer:d})):X("",!0),o.value.size?(D(),j(Xn,{key:1,getPopupContainer:d})):X("",!0),o.value.setting?(D(),j(Qn,{key:2,onColumnsChange:i,getPopupContainer:d,cache:o.value.settingCache},null,8,["cache"])):X("",!0),o.value.fullScreen?(D(),j(ea,{key:3,getPopupContainer:d})):X("",!0)]))}}),aa=ee({name:"BasicTableTitle",__name:"TableTitle",props:{title:{type:[Function,String]},getSelectRows:{type:Function},helpMessage:{type:[String,Array]}},setup(n){const a=n,{prefixCls:t}=xe("basic-table-title"),l=P(()=>{const{title:o,getSelectRows:i=()=>{}}=a;let d=o;return q(o)&&(d=o({selectRows:i()})),d});return(o,i)=>l.value?(D(),j(e(cn),{key:0,class:ve(e(t)),helpMessage:n.helpMessage},{default:T(()=>[re(U(l.value),1)]),_:1},8,["class","helpMessage"])):X("",!0)}}),la={key:0},oa={key:1},sa=ee({name:"TableSelectBar",__name:"TableSelectionBar",props:{count:{default:()=>0},clearSelectedRowKeys:{}},setup(n){const a=n,{t}=_e(),{prefixCls:l}=xe("table-select-bar");return(o,i)=>{const d=ft("a-button");return D(),j(e(In),{type:"info",showIcon:"",class:ve([e(l)])},{message:T(()=>[a.count>0?(D(),de("span",la,U(e(t)("component.table.selectionBarTips",{count:a.count})),1)):(D(),de("span",oa,U(e(t)("component.table.selectionBarEmpty")),1)),dt(R(d,{type:"link",onClick:o.clearSelectedRowKeys,size:"small"},{default:T(()=>[re(U(e(t)("component.table.selectionBarClear")),1)]),_:1},8,["onClick"]),[[gt,a.count>0]])]),_:1},8,["class"])}}}),ca=rn(sa,[["__scopeId","data-v-80ee960a"]]),ia={style:{width:"100%"}},ra={key:0,style:{margin:"5px"}},ua={key:1,style:{margin:"5px"}},fa={class:"flex items-center"},da=ee({name:"BasicTableHeader",__name:"TableHeader",props:{title:{type:[Function,String]},tableSetting:{type:Object},showTableSetting:{type:Boolean},titleHelpMessage:{type:[String,Array],default:""},clearSelectedRowKeys:{type:Function},count:{type:Number,default:0},showSelectionBar:{type:Boolean,default:!1}},emits:["columns-change"],setup(n,{emit:a}){const t=n,{prefixCls:l}=xe("basic-table-header");function o(i){a("columns-change",i)}return(i,d)=>(D(),de("div",ia,[i.$slots.headerTop?(D(),de("div",ra,[Ce(i.$slots,"headerTop")])):X("",!0),n.showSelectionBar?(D(),de("div",ua,[R(ca,{clearSelectedRowKeys:t.clearSelectedRowKeys,count:t.count},null,8,["clearSelectedRowKeys","count"])])):X("",!0),fe("div",fa,[i.$slots.tableTitle?Ce(i.$slots,"tableTitle",{key:0}):X("",!0),!i.$slots.tableTitle&&n.title?(D(),j(aa,{key:1,helpMessage:n.titleHelpMessage,title:n.title},null,8,["helpMessage","title"])):X("",!0),fe("div",{class:ve(`${e(l)}__toolbar`)},[Ce(i.$slots,"toolbar"),i.$slots.toolbar&&n.showTableSetting?(D(),j(e(mt),{key:0,type:"vertical"})):X("",!0),n.showTableSetting?(D(),j(na,{key:1,setting:n.tableSetting,onColumnsChange:o},null,8,["setting"])):X("",!0)],2)])]))}});function ga(n,a,t,l){return{getHeaderProps:P(()=>{const{title:i,showTableSetting:d,titleHelpMessage:g,tableSetting:c,showSelectionBar:s}=e(n),w=!a.tableTitle&&!i&&!a.toolbar&&!d;return w&&!Le(i)?{}:{title:w?null:()=>je(da,{title:i,titleHelpMessage:g,showTableSetting:d,tableSetting:c,onColumnsChange:t.onColumnsChange,clearSelectedRowKeys:l.clearSelectedRowKeys,count:l.getSelectRowKeys().length,showSelectionBar:s},F(F(F({},a.toolbar?{toolbar:()=>Ue(a,"toolbar")}:{}),a.tableTitle?{tableTitle:()=>Ue(a,"tableTitle")}:{}),a.headerTop?{headerTop:()=>Ue(a,"headerTop")}:{}))}})}}function ha(n,a,t){const l=N([]),o=P(()=>e(n).autoCreateKey&&!e(n).rowKey),i=P(()=>{const{rowKey:S}=e(n);return e(o)?ue:S}),d=P(()=>{const{isTreeTable:S}=e(n);return S?{expandedRowKeys:e(l),onExpandedRowsChange:x=>{l.value=x,t("expanded-rows-change",x)}}:{}});function g(){const S=A();l.value=S}function c(){l.value=[]}function s(S){const{isTreeTable:x}=e(n);x&&(l.value=[...l.value,...S])}function w(S){const{isTreeTable:x}=e(n);x&&(l.value=e(l).filter(u=>!S.includes(u)))}function A(S){const x=[],{childrenColumnName:u}=e(n);return we(S||e(a)).forEach(f=>{x.push(f[e(i)]);const v=f[u||"children"];v!=null&&v.length&&x.push(...A(v))}),x}return{getExpandOption:d,expandAll:g,collapseAll:c,expandRows:s,collapseRows:w}}function ma(n,a,t,l){const o=P(()=>(e(l)||[]).length===0),i=P(()=>{const{summaryFunc:g,showSummary:c,summaryData:s}=e(n);return c&&!e(o)?()=>je(Pn,{summaryFunc:g,summaryData:s,scroll:e(a)}):void 0});Ge(()=>{d()});function d(){const{showSummary:g}=e(n);!g||e(o)||De(()=>{const c=e(t);if(!c)return;const s=c.$el.querySelector(" .ant-table-content,  .ant-table-body");un({el:s,name:"scroll",listener:()=>{const w=c.$el.querySelector('.ant-table-footer .ant-table-container  [class^="ant-table-"]');!w||!s||(w.scrollLeft=s.scrollLeft)},wait:0,options:!0})})}return{getFooterProps:i}}function pa(n,a,t,l){const o=P(()=>{const{formConfig:c}=e(n),{submitButtonOptions:s}=c||{};return me(F({showAdvancedButton:!0},c),{submitButtonOptions:F({loading:e(l)},s),compact:!0})}),i=P(()=>Object.keys(a).map(s=>s.startsWith("form-")?s:null).filter(s=>!!s));function d(c){var s,w;return c&&(w=(s=c==null?void 0:c.replace)==null?void 0:s.call(c,/form-/,""))!=null?w:""}function g(c){const{handleSearchInfoFn:s}=e(n);s&&q(s)&&(c=s(c)||c),t({searchInfo:c,page:1})}return{getFormProps:o,replaceFormSlotKey:d,getFormSlotKeys:i,handleSearchInfoChange:g}}const ka=ee({name:"BasicTable",__name:"BasicTable",props:$n,emits:["fetch-success","fetch-error","selection-change","register","row-click","row-dbClick","row-contextmenu","row-mouseenter","row-mouseleave","edit-end","edit-cancel","edit-row-end","edit-change","expanded-rows-change","change","columns-change"],setup(n,{expose:a,emit:t}){const l=n,o=ut(),i=Gt(),d=N(null),g=N([]),c=N(null),s=N(null),w=N(),{prefixCls:A}=xe("basic-table"),[S,x]=Yt(),u=P(()=>F(F({},l),e(w))),f=Wt(fn,!1);Ge(()=>{e(f)&&l.canResize&&dn()});const{getLoading:v,setLoading:y}=Vn(u),{getPaginationInfo:p,getPagination:O,setPagination:I,setShowPagination:B,getShowPagination:G}=Bn(u),{getRowSelection:te,getRowSelectionRef:ne,getSelectRows:ye,setSelectedRows:h,clearSelectedRowKeys:C,getSelectRowKeys:$,deleteSelectRowByKey:E,setSelectedRowKeys:z}=jn(u,g,t),{handleTableChange:L,getDataSourceRef:M,getDataSource:K,getRawDataSource:ae,setTableData:Z,updateTableDataRecord:le,deleteTableDataRecord:oe,insertTableDataRecord:W,findTableDataRecord:J,fetch:se,getRowKey:ge,reload:he,getAutoCreateKey:Ie,updateTableData:Te}=Un(u,{tableData:g,getPaginationInfo:p,setLoading:y,setPagination:I,getFieldsValue:x.getFieldsValue,clearSelectedRowKeys:C},t);function ke(H,Q,V,Pe){L(H,Q,V),t("change",H,Q,V);const{onChange:Me}=e(u);Me&&q(Me)&&Me(H,Q,V,Pe)}const{getViewColumns:r,getColumns:b,setCacheColumnsByField:_,setCacheColumns:m,setColumnWidth:k,setColumns:ce,getColumnsRef:ie,getCacheColumns:St}=Ln(u,p),{getScrollRef:Ze,redoHeight:Qe}=Dn(u,d,ie,ne,M,c,s),{scrollTo:bt}=Gn(d,M),{customRow:wt}=qn(u,{setSelectedRowKeys:z,getSelectRowKeys:$,clearSelectedRowKeys:C,getAutoCreateKey:Ie,emit:t}),{getRowClassName:yt}=Jn(u,A),{getExpandOption:_t,expandAll:Tt,expandRows:Rt,collapseRows:xt,collapseAll:It}=ha(u,g,t),kt={onColumnsChange:H=>{var Q,V;t("columns-change",H),(V=(Q=e(u)).onColumnsChange)==null||V.call(Q,H)}},Ft={clearSelectedRowKeys:C,getSelectRowKeys:$},{getHeaderProps:Pt}=ga(u,i,kt,Ft),{getFooterProps:$t}=ma(u,Ze,d,M),{getFormProps:Dt,replaceFormSlotKey:At,getFormSlotKeys:Et,handleSearchInfoChange:Ot}=pa(u,i,se,v),Fe=P(()=>{const H=e(M);let Q=F(me(F(F(me(F({},o),{customRow:wt}),e(u)),e(Pt)),{scroll:e(Ze),loading:e(v),tableLayout:"fixed",rowSelection:e(ne),rowKey:e(ge),columns:we(e(r)),pagination:we(e(p)),dataSource:H,footer:e($t)}),e(_t));return Q=Je(Q,["class","onChange"]),Q}),Kt=P(()=>{const H=e(Fe);return[A,o.class,{[`${A}-form-container`]:H.useSearchForm,[`${A}--inset`]:H.inset}]}),Bt=P(()=>{const{emptyDataIsShowTable:H,useSearchForm:Q}=e(u);return H||!Q?!0:!!e(M).length});function Ht(H){w.value=F(F({},e(w)),H)}const Oe={reload:he,getSelectRows:ye,setSelectedRows:h,clearSelectedRowKeys:C,getSelectRowKeys:$,deleteSelectRowByKey:E,setPagination:I,setTableData:Z,updateTableDataRecord:le,deleteTableDataRecord:oe,insertTableDataRecord:W,findTableDataRecord:J,redoHeight:Qe,setSelectedRowKeys:z,setColumns:ce,setLoading:y,getDataSource:K,getRawDataSource:ae,setProps:Ht,getRowSelection:te,getPaginationRef:O,getColumns:b,getCacheColumns:St,emit:t,updateTableData:Te,setShowPagination:B,getShowPagination:G,setCacheColumnsByField:_,expandAll:Tt,collapseAll:It,expandRows:Rt,collapseRows:xt,scrollTo:bt,getSize:()=>e(Fe).size,setCacheColumns:m};return Xt(me(F({},Oe),{wrapRef:c,getBindValues:Fe})),t("register",Oe,x),a(F({tableElRef:d},Oe)),(H,Q)=>(D(),de("div",{ref_key:"wrapRef",ref:c,class:ve(Kt.value)},[Fe.value.useSearchForm?(D(),j(e(qt),tt({key:0,ref_key:"formRef",ref:s,submitOnReset:""},e(Dt),{tableAction:Oe,onRegister:e(S),onSubmit:e(Ot),onAdvancedChange:e(Qe)}),et({_:2},[Ve(e(Et),V=>({name:e(At)(V),fn:T(Pe=>[Ce(H.$slots,V,Ke(Be(Pe||{})))])}))]),1040,["onRegister","onSubmit","onAdvancedChange"])):X("",!0),dt(R(e(kn),tt({ref_key:"tableElRef",ref:d},Fe.value,{rowClassName:e(yt),onChange:ke,onResizeColumn:e(k)}),et({headerCell:T(({column:V})=>[Ce(H.$slots,"headerCell",Ke(Be({column:V})),()=>[R(On,{column:V},null,8,["column"])])]),bodyCell:T(V=>[Ce(H.$slots,"bodyCell",Ke(Be(V||{})))]),_:2},[Ve(Object.keys(H.$slots),V=>({name:V,fn:T(Pe=>[Ce(H.$slots,V,Ke(Be(Pe||{})))])}))]),1040,["rowClassName","onResizeColumn"]),[[gt,Bt.value]])],2))}});export{ka as _,On as a};
