var me=Object.defineProperty,he=Object.defineProperties;var ye=Object.getOwnPropertyDescriptors;var ee=Object.getOwnPropertySymbols;var ve=Object.prototype.hasOwnProperty,be=Object.prototype.propertyIsEnumerable;var te=(a,l,s)=>l in a?me(a,l,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[l]=s,H=(a,l)=>{for(var s in l||(l={}))ve.call(l,s)&&te(a,s,l[s]);if(ee)for(var s of ee(l))be.call(l,s)&&te(a,s,l[s]);return a},E=(a,l)=>he(a,ye(l));var A=(a,l,s)=>new Promise((c,t)=>{var u=i=>{try{r(s.next(i))}catch(d){t(d)}},e=i=>{try{r(s.throw(i))}catch(d){t(d)}},r=i=>i.done?c(i.value):Promise.resolve(i.value).then(u,e);r((s=s.apply(a,l)).next())});import{h as re,D as Me,q as Ce,X as He,L as Se,v as ke,Y as Be,Z as Fe,f as ie,V as Oe,d as we,s as Te,K as ce,t as Pe,w as _e}from"./entry/index-1163f12d-1703821863576.js";import{h as V,u as o,d as N,G as $e,l as S,i as Ne,f as h,c as k,w as ue,o as De,b as de,x as T,q as Re,Z as M,a8 as _,a9 as y,n as We,_ as z,N as P,af as xe,F as Ee,ab as U,a1 as je,a7 as Le,E as Z,a0 as G,ac as j,J as Ae,g as K,y as Ie,ad as oe,aa as ne,ai as ae,aj as le,r as pe,H as I}from"./vue-d56f5f31.js";import{M as qe,aB as ze,T as Y,aC as Ve,aD as Xe,o as q,e as fe,a as Ye}from"./antd-090f1744.js";import{u as Ue}from"./useWindowSizeFn-ab2a372a.js";const{t:se}=re(),Ze={open:{type:Boolean},scrollTop:{type:Boolean,default:!0},height:{type:Number},minHeight:{type:Number},draggable:{type:Boolean,default:!0},centered:{type:Boolean},cancelText:{type:String,default:se("common.cancelText")},okText:{type:String,default:se("common.okText")},closeFunc:Function},Q=Object.assign({},Ze,{defaultFullscreen:{type:Boolean},canFullscreen:{type:Boolean,default:!0},wrapperFooterOffset:{type:Number,default:0},helpMessage:[String,Array],useWrapper:{type:Boolean,default:!0},loading:{type:Boolean},loadingTip:{type:String},showCancelBtn:{type:Boolean,default:!0},showOkBtn:{type:Boolean,default:!0},wrapperProps:Object,afterClose:Function,bodyStyle:Object,closable:{type:Boolean,default:!0},closeIcon:Object,confirmLoading:{type:Boolean},destroyOnClose:{type:Boolean},footer:Object,getContainer:Function,mask:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},keyboard:{type:Boolean,default:!0},maskStyle:Object,okType:{type:String,default:"primary"},okButtonProps:Object,cancelButtonProps:Object,title:{type:String},open:{type:Boolean},width:[String,Number],wrapClassName:{type:String},zIndex:{type:Number}});function Ge(a){const l=(t,u)=>getComputedStyle(t)[u],s=t=>{if(!t)return;t.setAttribute("data-drag",o(a.draggable));const u=t.querySelector(".ant-modal-header"),e=t.querySelector(".ant-modal");!u||!e||!o(a.draggable)||(u.style.cursor="move",u.onmousedown=r=>{if(!r)return;const i=r.clientX,d=r.clientY,C=document.body.clientWidth,f=document.documentElement.clientHeight,p=e.offsetWidth,g=e.offsetHeight,m=e.offsetLeft,v=C-e.offsetLeft-p,B=e.offsetTop,F=f-e.offsetTop-g,b=l(e,"left"),D=l(e,"top");let R=+b,W=+D;b.includes("%")?(R=+document.body.clientWidth*(+b.replace(/%/g,"")/100),W=+document.body.clientHeight*(+D.replace(/%/g,"")/100)):(R=+b.replace(/px/g,""),W=+D.replace(/px/g,"")),document.onmousemove=function(L){let w=L.clientX-i,n=L.clientY-d;-w>m?w=-m:w>v&&(w=v),-n>B?n=-B:n>F&&(n=F),e.style.cssText+=`;left:${w+R}px;top:${n+W}px;`},document.onmouseup=()=>{document.onmousemove=null,document.onmouseup=null}})},c=()=>{const t=document.querySelectorAll(".ant-modal-wrap");for(const u of Array.from(t)){if(!u)continue;const e=l(u,"display"),r=u.getAttribute("data-drag");e!=="none"&&(r===null||o(a.destroyOnClose))&&s(u)}};V(()=>{!o(a.open)||!o(a.draggable)||Me(()=>{c()},30)})}function Je(a){return typeof a=="function"||Object.prototype.toString.call(a)==="[object Object]"&&!Ne(a)}const Ke=N({name:"Modal",inheritAttrs:!1,props:Q,emits:["cancel"],setup(a,{slots:l,emit:s}){const{open:c,draggable:t,destroyOnClose:u}=$e(a),e=Ce();Ge({open:c,destroyOnClose:u,draggable:t});const r=i=>{s("cancel",i)};return()=>{let i;const d=E(H(H({},o(e)),a),{onCancel:r});return S(qe,d,Je(i=He(l))?i:{default:()=>[i]})}}}),ge=Symbol();function Qe(a){return ke(a,ge)}function pt(){return Se(ge)}const et=["loading-tip"],tt=N({name:"ModalWrapper",inheritAttrs:!1,__name:"ModalWrapper",props:{loading:{type:Boolean},useWrapper:{type:Boolean,default:!0},modalHeaderHeight:{type:Number,default:57},modalFooterHeight:{type:Number,default:74},minHeight:{type:Number,default:200},height:{type:Number},footerOffset:{type:Number,default:0},open:{type:Boolean},fullScreen:{type:Boolean},loadingTip:{type:String}},emits:["height-change","ext-height"],setup(a,{expose:l,emit:s}){const c=a,t=h(null),u=h(null),e=h(0),r=h(0),i=h(0);Ue(f.bind(null)),Be(u,()=>{f()},{attributes:!0,subtree:!0}),Qe({redoModalHeight:f});const d=k(()=>({minHeight:`${c.minHeight}px`,[c.fullScreen?"height":"maxHeight"]:`${o(e)}px`}));V(()=>{c.useWrapper&&f()}),ue(()=>c.fullScreen,p=>{f(),p?r.value=e.value:e.value=r.value}),De(()=>{const{modalHeaderHeight:p,modalFooterHeight:g}=c;s("ext-height",p+g)}),de(()=>{});function C(){return A(this,null,function*(){T(()=>{var g;const p=o(t);p&&((g=p==null?void 0:p.scrollTo)==null||g.call(p,0))})})}function f(){return A(this,null,function*(){if(!c.open)return;const p=o(t);if(!p)return;const g=p.$el.parentElement;if(g){g.style.padding="0",yield T();try{const m=g.parentElement&&g.parentElement.parentElement;if(!m)return;const v=getComputedStyle(m).top,B=Number.parseInt(v);let F=window.innerHeight-B*2+(c.footerOffset||0)-c.modalFooterHeight-c.modalHeaderHeight;B<40&&(F-=26),yield T();const b=o(u);if(!b)return;yield T(),i.value=b.scrollHeight,c.fullScreen?e.value=window.innerHeight-c.modalFooterHeight-c.modalHeaderHeight-28:e.value=c.height?c.height:i.value>F?F:i.value,s("height-change",o(e))}catch(m){}}})}return l({scrollTop:C,setModalHeight:f}),(p,g)=>{const m=Re("loading");return M(),_(o(Fe),{ref_key:"wrapperRef",ref:t,scrollHeight:i.value},{default:y(()=>[We((M(),z("div",{ref_key:"spinRef",ref:u,style:xe(d.value),"loading-tip":a.loadingTip},[P(p.$slots,"default")],12,et)),[[m,a.loading]])]),_:3},8,["scrollHeight"])}}}),ot=N({name:"ModalClose",__name:"ModalClose",props:{canFullscreen:{type:Boolean,default:!0},fullScreen:{type:Boolean}},emits:["cancel","fullscreen"],setup(a,{emit:l}){const s=a,{prefixCls:c}=ie("basic-modal-close"),{t}=re(),u=k(()=>[c,`${c}--custom`,{[`${c}--can-full`]:s.canFullscreen}]);function e(i){l("cancel",i)}function r(i){i==null||i.stopPropagation(),i==null||i.preventDefault(),l("fullscreen")}return(i,d)=>(M(),z("div",{class:je(u.value)},[a.canFullscreen?(M(),z(Ee,{key:0},[a.fullScreen?(M(),_(o(Y),{key:0,title:o(t)("component.modal.restore"),placement:"bottom"},{default:y(()=>[S(o(ze),{role:"full",onClick:r})]),_:1},8,["title"])):(M(),_(o(Y),{key:1,title:o(t)("component.modal.maximize"),placement:"bottom"},{default:y(()=>[S(o(Ve),{role:"close",onClick:r})]),_:1},8,["title"]))],64)):U("",!0),S(o(Y),{title:o(t)("component.modal.close"),placement:"bottom"},{default:y(()=>[S(o(Xe),{onClick:e})]),_:1},8,["title"])],2))}});const nt=N({name:"BasicModalFooter",__name:"ModalFooter",props:Q,emits:["ok","cancel"],setup(a,{emit:l}){function s(t){l("ok",t)}function c(t){l("cancel",t)}return(t,u)=>{const e=Le("a-button");return M(),z("div",null,[P(t.$slots,"insertFooter"),t.showCancelBtn?(M(),_(e,j({key:0},t.cancelButtonProps,{onClick:c}),{default:y(()=>[Z(G(t.cancelText),1)]),_:1},16)):U("",!0),P(t.$slots,"centerFooter"),t.showOkBtn?(M(),_(e,j({key:1,type:t.okType,onClick:s,loading:t.confirmLoading},t.okButtonProps),{default:y(()=>[Z(G(t.okText),1)]),_:1},16,["type","loading"])):U("",!0),P(t.$slots,"appendFooter")])}}}),at=N({name:"BasicModalHeader",__name:"ModalHeader",props:{helpMessage:{type:[String,Array]},title:{type:String}},setup(a){return(l,s)=>(M(),_(o(Oe),{helpMessage:a.helpMessage},{default:y(()=>[Z(G(a.title),1)]),_:1},8,["helpMessage"]))}});function lt(a){const l=h(!1),s=k(()=>{const t=o(a.wrapClassName)||"";return o(l)?`fullscreen-modal ${t} `:o(t)});function c(t){t&&t.stopPropagation(),l.value=!o(l)}return{getWrapClassName:s,handleFullScreen:c,fullScreenRef:l}}const st=N({name:"BasicModal",inheritAttrs:!1,__name:"BasicModal",props:Q,emits:["open-change","height-change","cancel","ok","register","update:open"],setup(a,{emit:l}){const s=a,c=Ae(),t=h(!1),u=h(null),e=h(null),{prefixCls:r}=ie("basic-modal"),i=h(0),d={setModalProps:D,emitOpen:void 0,redoModalHeight:()=>{T(()=>{o(e)&&o(e).setModalHeight()})}},C=K();C&&l("register",d,C.uid);const f=k(()=>H(H({},s),o(u))),{handleFullScreen:p,getWrapClassName:g,fullScreenRef:m}=lt({modalWrapperRef:e,extHeightRef:i,wrapClassName:Ie(f.value,"wrapClassName")}),v=k(()=>{const n=E(H({},o(f)),{open:o(t),okButtonProps:void 0,cancelButtonProps:void 0,title:void 0});return E(H({},n),{wrapClassName:o(g)})}),B=k(()=>{const n=E(H(H({},c),o(f)),{open:o(t)});return n.wrapClassName=`${(n==null?void 0:n.wrapClassName)||""} ${o(g)}vben-basic-modal-wrap`,o(m)?q(n,["height","title"]):q(n,"title")}),F=k(()=>{if(!o(m))return o(v).height});V(()=>{t.value=!!s.open,m.value=!!s.defaultFullscreen}),ue(()=>o(t),n=>{l("open-change",n),l("update:open",n),C&&d.emitOpen&&d.emitOpen(n,C.uid),T(()=>{s.scrollTop&&n&&o(e)&&o(e).scrollTop()})},{immediate:!1});function b(n){return A(this,null,function*(){var X,O;if(n==null||n.stopPropagation(),!((O=(X=n.target)==null?void 0:X.classList)!=null&&O.contains(r+"-close--custom"))){if(s.closeFunc&&fe(s.closeFunc)){const x=yield s.closeFunc();t.value=!x;return}t.value=!1,l("cancel",n)}})}function D(n){u.value=we(o(u)||{},n),Reflect.has(n,"open")&&(t.value=!!n.open),Reflect.has(n,"defaultFullscreen")&&(m.value=!!n.defaultFullscreen)}function R(n){l("ok",n)}function W(n){l("height-change",n)}function L(n){i.value=n}function w(n){s.canFullscreen&&(n.stopPropagation(),p(n))}return(n,X)=>(M(),_(o(Ke),j(B.value,{onCancel:b}),oe({default:y(()=>[S(tt,j({useWrapper:v.value.useWrapper,footerOffset:n.wrapperFooterOffset,fullScreen:o(m),ref_key:"modalWrapperRef",ref:e,loading:v.value.loading,"loading-tip":v.value.loadingTip,minHeight:v.value.minHeight,height:F.value,open:t.value,modalFooterHeight:n.footer!==void 0&&!n.footer?0:void 0},o(q)(v.value.wrapperProps,"open","height","modalFooterHeight"),{onExtHeight:L,onHeightChange:W}),{default:y(()=>[P(n.$slots,"default")]),_:3},16,["useWrapper","footerOffset","fullScreen","loading","loading-tip","minHeight","height","open","modalFooterHeight"])]),_:2},[n.$slots.closeIcon?void 0:{name:"closeIcon",fn:y(()=>[S(ot,{canFullscreen:v.value.canFullscreen,fullScreen:o(m),onCancel:b,onFullscreen:o(p)},null,8,["canFullscreen","fullScreen","onFullscreen"])]),key:"0"},n.$slots.title?void 0:{name:"title",fn:y(()=>[S(at,{helpMessage:v.value.helpMessage,title:f.value.title,onDblclick:w},null,8,["helpMessage","title"])]),key:"1"},n.$slots.footer?void 0:{name:"footer",fn:y(()=>[S(nt,j(B.value,{onOk:R,onCancel:b}),oe({_:2},[ne(Object.keys(n.$slots),O=>({name:O,fn:y(x=>[P(n.$slots,O,ae(le(x||{})))])}))]),1040)]),key:"2"},ne(Object.keys(o(q)(n.$slots,"default")),O=>({name:O,fn:y(x=>[P(n.$slots,O,ae(le(x||{})))])}))]),1040))}}),$=pe({}),J=pe({});function ft(){const a=h(null),l=h(!1),s=h(0);function c(e,r){if(!K())throw new Error("useModal() can only be used inside setup() or functional components!");s.value=r,de(()=>{a.value=null,l.value=!1,$[String(o(s))]=null}),!(o(l)&&Te()&&e===o(a))&&(a.value=e,l.value=!0,e.emitOpen=(i,d)=>{J[d]=i})}const t=()=>{const e=o(a);return e||ce("useModal instance is undefined!"),e},u={setModalProps:e=>{var r;(r=t())==null||r.setModalProps(e)},getOpen:k(()=>J[~~o(s)]),redoModalHeight:()=>{var e,r;(r=(e=t())==null?void 0:e.redoModalHeight)==null||r.call(e)},openModal:(e=!0,r,i=!0)=>{var f;if((f=t())==null||f.setModalProps({open:e}),!r)return;const d=o(s);if(i){$[d]=null,$[d]=I(r);return}Ye(I($[d]),I(r))||($[d]=I(r))},closeModal:()=>{var e;(e=t())==null||e.setModalProps({open:!1})}};return[c,u]}const gt=a=>{const l=h(null),s=K(),c=h(0),t=()=>{const e=o(l);return e||ce("useModalInner instance is undefined!"),e},u=(e,r)=>{Pe(()=>{l.value=null}),c.value=r,l.value=e,s==null||s.emit("register",e,r)};return V(()=>{const e=$[o(c)];e&&(!a||!fe(a)||T(()=>{a(e)}))}),[u,{changeLoading:(e=!0)=>{var r;(r=t())==null||r.setModalProps({loading:e})},getOpen:k(()=>J[~~o(c)]),changeOkLoading:(e=!0)=>{var r;(r=t())==null||r.setModalProps({confirmLoading:e})},closeModal:()=>{var e;(e=t())==null||e.setModalProps({open:!1})},setModalProps:e=>{var r;(r=t())==null||r.setModalProps(e)},redoModalHeight:()=>{var r;const e=(r=t())==null?void 0:r.redoModalHeight;e&&e()}}]},mt=_e(st);export{mt as B,gt as a,ft as b,pt as u};
